### Creates a Cubic Spline Function for Experimentally Obtained Thrust Curve Data ###

from numpy import arange, linspace, array
from matplotlib import pyplot as plt
from scipy.interpolate import CubicSpline

F = array([0.605785905,0.636368676,0.636368676,0.605785905,0.636368676,0.636368676,0.636368676, \
           0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676, \
           0.636368676,0.636368676,0.636368676,0.636368676,0.605785905,0.636368676,0.636368676, \
           0.636368676,0.636368676,0.636368676,0.636368676,0.605785905,0.636368676,0.636368676, \
           0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676, \
           0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676, \
           0.605785905,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676, \
           0.605785905,0.636368676,0.605785905,0.636368676,0.636368676,0.636368676,0.636368676, \
           0.636368676,0.636368676,0.636368676,0.636368676,0.605785905,0.605785905,0.636368676, \
           0.636368676,0.636368676,0.636368676,0.636368676,0.605785905,0.636368676,0.605785905, \
           0.605785905,0.636368676,0.636368676,0.605785905,0.636368676,0.605785905,0.636368676, \
           0.636368676,0.605785905,0.636368676,0.605785905,0.605785905,0.605785905,0.636368676, \
           0.605785905,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676, \
           0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.605785905,0.636368676, \
           0.636368676,0.636368676,0.605785905,0.605785905,0.636368676,0.636368676,0.636368676, \
           0.605785905,0.636368676,0.636368676,0.636368676,0.636368676,0.605785905,0.636368676, \
           0.636368676,0.636368676,0.636368676,0.636368676,0.605785905,0.636368676,0.636368676, \
           0.636368676,0.636368676,0.636368676,0.636368676,0.605785905,0.605785905,0.636368676, \
           0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676, \
           0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676, \
           0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676, \
           0.636368676,0.636368676,0.636368676,0.605785905,0.636368676,0.636368676,0.605785905, \
           0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.605785905,0.636368676, \
           0.605785905,0.636368676,0.636368676,0.636368676,0.605785905,0.605785905,0.636368676, \
           0.636368676,0.636368676,0.636368676,0.605785905,0.636368676,0.605785905,0.636368676, \
           0.697534217,0.728116988,0.758699759,0.78928253,0.850448071,0.881030842,1.001450501, \
           1.276695438,1.915110776,2.949190711,4.409518012,6.114507479,7.817585522,9.644906072, \
           11.37856689,12.96122527,13.53847507,10.25273864,7.056839101,5.445509369,4.562431865, \
           4.105601728,3.801685444,3.648771591,3.528351931,3.49776916,3.436603619,3.283689765, \
           2.91860794,2.461777803,1.976276318,1.550028951,1.276695438,1.093198814,1.001450501, \
           0.909702189,0.8198653,0.78928253,0.758699759,0.728116988,0.697534217,0.697534217, \
           0.697534217,0.666951447,0.697534217,0.666951447,0.666951447,0.666951447,0.666951447, \
           0.666951447,0.666951447,0.666951447,0.666951447,0.666951447,0.666951447,0.666951447, \
           0.666951447,0.666951447,0.666951447,0.666951447,0.636368676,0.636368676,0.666951447, \
           0.636368676,0.666951447,0.666951447,0.636368676,0.666951447,0.636368676,0.636368676, \
           0.636368676,0.636368676,0.636368676,0.636368676,0.666951447,0.636368676,0.636368676, \
           0.636368676,0.636368676,0.636368676,0.666951447,0.636368676,0.666951447,0.636368676, \
           0.636368676,0.636368676,0.636368676,0.636368676,0.666951447,0.666951447,0.636368676, \
           0.666951447,0.636368676,0.636368676,0.666951447,0.636368676,0.636368676,0.666951447, \
           0.666951447,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676, \
           0.636368676,0.636368676,0.636368676,0.636368676,0.666951447,0.666951447,0.636368676, \
           0.666951447,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676, \
           0.666951447,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.666951447, \
           0.666951447,0.636368676,0.666951447,0.636368676,0.636368676,0.636368676,0.636368676, \
           0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676, \
           0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676,0.636368676, \
           0.636368676,0.636368676,0.666951447,0.636368676,0.636368676,0.636368676,0.666951447, \
           3.406020848,3.558934702,0.8198653,-0.154960516,-0.550625112,-0.701627542,1.305366785, \
           0.8198653,0.605785905,0.515949016,0.393617934,0.393617934,0.363035163,0.393617934, \
           0.363035163,0.393617934,0.363035163,0.393617934,0.393617934,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.363035163,0.393617934,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.393617934,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.332452392,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.332452392,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.332452392,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.332452392, \
           0.363035163,0.363035163,0.332452392,0.363035163,0.332452392,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.332452392,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.332452392,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.332452392,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.332452392,0.363035163,0.332452392,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.332452392,0.363035163,0.363035163,0.363035163,0.363035163,0.332452392,0.363035163, \
           0.332452392,0.363035163,0.332452392,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.332452392,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.332452392,0.363035163,0.363035163,0.332452392, \
           0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.332452392,0.363035163, \
           0.363035163,0.363035163,0.332452392,0.363035163,0.363035163,0.332452392,0.363035163, \
           0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163,0.332452392, \
           0.363035163,0.332452392,0.363035163,0.363035163,0.363035163,0.363035163,0.363035163, \
           0.363035163,0.363035163,0.363035163,])

t = arange(0,11.81,.02)
F = F - 0.630216969  # Subtract the background

startbound = 174
endbound = 220

t_cropped = t[startbound:endbound]
F_cropped = F[startbound:endbound]

cs = CubicSpline(t_cropped, F_cropped)

if __name__ == "__main__":
  t_new = linspace(t_cropped.min(), t_cropped.max(), 100)
  F_new = cs(t_new)

  plt.figure()
  plt.plot(t_cropped,F_cropped, '.', label = "Data")
  plt.plot(t_new,F_new, label = "Cubic Spline")
  plt.legend()
  plt.xlabel("Time (S)")
  plt.ylabel("Force (N)")
  plt.title("Thrust Force Data")
  plt.show()
